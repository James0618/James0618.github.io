---
layout: post
title: '外参标定理论介绍'
date: 2019-08-10
author: James
color: rgb(255,210,32)
cover: '../2019/08/09/time.png'
tags: ROS手眼标定
---

# 外参标定理论介绍

&#8195;&#8195;在机器人视觉应用中，手眼标定是一个至关重要的环节，没有手眼标定得到的外参矩阵就无法从相机获得到的图像信息有效的解析到物体的状态。手眼标定的目的就是为了获取机器人坐标系和相机坐标系之间的变换矩阵，也就是我们在内参标定理论中介绍的外参矩阵$[R \ \ t]$，在ROS中它可以提供相机坐标系和机器人坐标系之间的tf，将相机坐标系加入到机器人的tf_tree中。

&#8195;&#8195;在机器人手眼标定中共有两类方法，分类依据是相机固定的位置，将相机固定在机器人外的平台上时称为“眼在外”也就是“eye to hand”，而将相机固定在机器人的末端时则称为“眼在手”也就是“eye in hand”。



## 手眼关系的数学描述

&#8195;&#8195;本小节中我们将会介绍“眼在外”情况下的手眼标定问题，在之后的外参标定操作中也是基于“眼在外”这一情况进行实践的。在“眼在外”的情况中，我们的已知量为机器人各关节之间的变换矩阵以及机器人和底座之间的变换矩阵，由于已知标定板的型号，因此可以在观测时可以通过内参标定理论中介绍的方法计算得到相机到标定板之间的变换矩阵，而我们的目标也就是需要求解的未知量就是相机和机器人底座或者末端之间的变换矩阵，它的表示形式如下所示：


$$
T_{base1}^{end} T_{camera1}^{base1} T_{object}^{camera1} = T_{base2}^{end} T_{camera2}^{base2} T_{object}^{camera2} \\
(T_{base2}^{end})^{-1} T_{base1}^{end} T_{camera1}^{base1} = 
T_{camera2}^{base2} T_{camera2}^{object} (T_{object}^{camera1})^{-1}
$$


&#8195;&#8195;让我来解释一下这个式子，在上式中的end表示机器人的末端抓取机构等，camera则表示相机，而object表示和机器人末端固连的标定板。上面的式子左右两边分别是两次测量，为了计算外参矩阵需要让机器人以及与其末端固连的标定板移动任意两个位姿，但是由于标定板是固定在机器人末端上的，因此无论移动多少个位姿机器人末端与标定板之间的变换矩阵是不变的，这也是两边的式子能够相等的基础。

&#8195;&#8195;之后将上边的等式转换一下形式就能写成下边的等式，注意到两次位姿移动中机器人底座和相机之间的变换矩阵$T_{camera}^{base}$应该是不变的，因此设它为$X$则可以将上式写成下面的形式：


$$
AX=XB
$$


&#8195;&#8195;可以证明无论采多少组数据，最终都可以写成上式的形式，因此求解外参矩阵的问题就转换为求解上面这方程中的$X$的问题了，这涉及到矩阵运算的相关知识在此就不赘述了，感兴趣的同学可以查看参考资料中给出的文章和链接进行学习，接下来我们将会详细介绍在ROS中如何使用Realsense D415相机和UR5机械臂进行手眼标定。



## 参考资料

[1] Shiu Y C, Ahmad S. Calibration of wrist-mounted robotic sensors by solving homogeneous transform equations of the form AX=XB[J]. IEEE Transactions on Robotics & Automation, 1989, 5(1):16-29.

[2] http://math.loyola.edu/~mili/Calibration/index.html